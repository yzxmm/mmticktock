# TikTak 跨年倒计时 (TikTakCountdown)

全手绘风格的桌面倒计时工具，专为主播设计。

## 功能特性
- **跨年倒计时**：自动计算距离 2026 年的时间。
- **智能切换**：跨年后自动变为正计时，直到 99:99。
- **手绘风格**：支持自定义手绘数字和背景图片。
- **透明背景**：无边框设计，完美融入直播画面。
- **时区选择**：右键菜单支持多国时区切换。

## 快速开始

1. **运行程序**：
   - 如果你下载的是 EXE 版本，直接双击运行即可。
   - 默认会加载 `assets` 文件夹下的图片。

2. **自定义资源**：
   - 在程序同级目录下创建 `assets` 文件夹（如果不存在）。
   - 放入你的手绘图片（参考 `docs/ASSETS_LIST.md`）。
   - 重启程序即可生效。

3. **操作说明**：
   - **移动窗口**：按住窗口任意位置（数字或背景）即可拖拽。
   - **右键菜单**：
     - **选择时区**：切换到你所在的地区时间。
     - **退出**：关闭程序。

## 开发与构建

如果你想自己修改代码或重新打包：

1. **安装依赖**：
   ```bash
   pip install PyQt5 pytz pyinstaller Pillow
   ```

2. **运行代码**：
   ```bash
   python main.py
   ```

3. **生成占位资源** (可选)：
   ```bash
   python generate_assets.py
   ```

4. **打包为 EXE**：
   - 双击运行 `build.bat`。
   - 或者在命令行执行：
     ```bash
     pyinstaller --noconsole --onefile --name "TikTakCountdown" --add-data "assets;assets" main.py
     ```
   - 生成的 EXE 文件位于 `dist` 文件夹中。

## 目录结构
```
TikTak/
├── main.py              # 主程序代码
├── generate_assets.py   # 资源生成脚本
├── build.bat            # 打包脚本
├── widgets.py           # UI组件（红框数字、蓝框容器）
├── assets.py            # 资源加载（图片、图标）
├── utils.py             # 通用工具（资源路径）
├── assets/              # 图片资源目录
│   ├── 0.png - 9.png
│   ├── colon.png
│   └── bg.png
├── docs/                # 文档
│   ├── DESIGN.md
│   └── ASSETS_LIST.md
│
├── layout_config.json   # 配置（可放在EXE同目录覆盖）
└── README.md            # 说明文档
```

## 使用说明
- 右键菜单
  - 调整布局：进入/退出调整模式。进入后会显示蓝框（整体容器）与红框（单个数字）。
  - 置顶窗口：是否保持在最前（默认关闭）。
  - 切换时区：常用时区快速切换。
  - 退出：关闭程序。
- 调整模式
  - 蓝框：拖动蓝框可整体移动；拖蓝框右下角可整体缩放。按住 Shift 等比例缩放。
  - 红框：拖动单个数字可移动；拖右下角可缩放。按住 Shift 等比例缩放。
  - 背景（黄框）：用于全局缩放窗口大小；按住 Shift 等比例缩放。
- 非调整模式
  - 在任意数字上按住左键可拖动整个窗口到桌面任意位置。
  - 数字拖出背景范围时不会被裁剪，窗口会自动扩展以容纳内容。
- 配置目标日期
  - 文件：[layout_config.json](file:///e:/mmticktock/layout_config.json) 中 `target_date` 字段（默认 `2026-01-01 00:00:00`）。
  - 打包后可将该文件与 EXE 放在同一目录以覆盖默认配置。
- 图标说明
  - 程序为无边框窗口，**不在窗口左上角内嵌图标**。
  - 保留应用图标（任务栏与 EXE），图片放在 `assets/icon.png` 或 `assets/icon.ico`。

## 近期更新（编辑模式）
- 黄框改为全局调整：在编辑模式下，黄色虚线框用于“全局缩放”窗口，支持按住 Shift 等比例缩放。
- 默认窗口尺寸与位置：默认窗口大小缩小为原来的一半（250×100），首次运行居中显示在屏幕中间。
- 蓝框可见性增强：整体组件的蓝色选框边框加粗并提高透明度，进入编辑模式自动显示。
- 数字不受黄框剪裁：数字拖出黄色框（背景区域）仍可显示；当内容超出窗口边界时，窗口会自动扩展以避免被裁剪。
- 文本已记录：以上变更已写入本文档，便于查阅。
 - 结构逻辑：黄框套蓝框，蓝框套红框；当蓝框移动或缩放时，黄框自动跟随并在超出范围时自动增大；当黄框缩放时，蓝框与红框一起按比例变化。

## 常见问题
- 蓝框看不见？
  - 在右键菜单选择“调整布局”。进入后蓝框会显示，并且始终在背景之上。
- Shift 等比例不生效？
  - 蓝框、红框、背景缩放都支持按住 Shift 等比例。如果仍无效，请检查是否处于调整模式。
